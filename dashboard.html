<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Dashboard Router</title>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <script src="js/supabase.js"></script>
  <script src="js/auth.js"></script>
</head>
<body>
  <div style="padding:3rem;text-align:center">Redirecting...</div>
  <script>
    (async ()=>{
      try {
        const { data: { user } } = await auth.getUser();
        if (!user) { window.location.replace('login.html'); return; }
        const profile = await db.getProfile(user.id);
        if (!profile) { window.location.replace('login.html'); return; }
        if (profile.role === 'teacher') window.location.replace('teacher-dashboard.html');
        else if (profile.role === 'student') window.location.replace('student-dashboard.html');
        else window.location.replace('login.html');
      } catch (e) {
        console.error(e);
        window.location.replace('login.html');
      }
    })();
  </script>
</body>
</html>
